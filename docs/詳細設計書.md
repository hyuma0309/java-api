##  詳細

### 概要
 
 1日1回商品APIのログを出力し、そのログを集計しデータベースに保存します。 ログ検索画面からデータベースに保存したログを検索することが可能です。
 全体的な流れは下記の画像を参考にして下さい。
 
 
 ![log画像](https://app.diagrams.net/?lightbox=1&highlight=0000ff&edit=_blank&layers=1&nav=1&title=Untitled%20Diagram.png#R7Vxbk5s2GP01zLQP6wEBAj3a63XSadrJZNMmfZSNbGgAuSB7vfn1kUCyuYjY6%2BBLuvaLxSdZAp3zXcWuYd8nmzcZXoZ%2F0IDEBjCDjWGPDQAs6Pn8S0ieSwnyQClYZFEgB%2B0Ej9FXIoWmlK6igOS1gYzSmEXLunBG05TMWE2Gs4w%2B1YfNaVxfdYkXpCV4nOFYSQfuTv4pClgo5RZEu463JFqEcnEfwLJjimdfFhldpXJFA9jz4lN2J1jNJR81D3FAnyoi%2B8Gw7zNKWdlKNvckFrurNk79jj2ruzXsUciSmF9YvFl0Tzp%2BbB3yY%2F5wGUlZdbmu%2BXyIEARz4nsBdh33TsK8xvFKzd9csLLa9tlNfhHgPCSBvMBxtEh5e8bvg2RcsCYZizhAQ9mRREEgZhRzLMXMyWYhuDgo4Qflt5j2Wc2%2FkY2UspnAwBYXBVLbZXOW0S%2FknsY0K27WRtCzMdz2KCqIm59HcVwZSazAJZ6Q05RNcBLFYuGPOKQJllLJc0usxG82iPjDjaOMEzii4pkIzpkWA4ma2AOyqYgkJm8ITQjLnvkQ2QuQZInUP8uT1087LiMoZWGFxpYvhVhq0GI7944FvCGJcBgp%2FJ%2BKFAMf7OcFnPlkOj%2BEFwEm%2Fnx2pbxwwCV5YVk%2FFTH2syLw0NQ0D2HFfE7g7FpZAS9qLSykYQWMmdyWwuurfYT%2FrWi5CbZZfKoiuBDflvoxv4%2Fy96W8xTS%2BWazuDOv4pjQlDSClSNEvK3emm31PYcTI4xLPxJJPnIBtSnVyvEaUtyReE7FGgyuuGlmh2qT49MMUG%2Bz3K8A8F1PUzfTEFHBjSo9MsRuexr4oU3Se5nim2DemnI4p0L8oU5z9MUkcFRDVnbwjNrfinnO6EvIq9gfD0qaDCgAqGAzHnJugFxSbZGsFNn3i7ToNH6LB29LBDU8Bt3uD%2B7xwO84l4YY3uM8LN0SXhLs7lQitndMuJdOsKeHLVYf15ttz7q2jdMEF7u7qI%2BWeeyxiWr1PpxyDeVxQKuS%2Bn6TdlLOO8vPgAArFZN5TzunChhfQ8GSbh9aI4pyAKHZ3JvF%2FJspxAeGZieI3%2FId7UaLoCtw3olwjUdBZibL%2B%2FGc4GScw%2FPDpdzd5%2BkDZ6rc7e3%2B00SxI5nxb8gEjs3Awo8lyVdYzK5Rolpd90%2FRsnVcfuqbpmJXU8R2ekvg9zSMZw0wpYzTR5JZMEKddVK35lwau8ohLAdlCTYNtN5CNciTQRIzIb%2BOoDh17h9HSHGA82IZvG8Nx0QDGyJQNxLtcw%2FeM0bBoDA3UVnQFes61NCZDWXvW6aiu%2FG31s81eI%2B8GNmptszbv7iNS0%2B6ztkrT3roOk%2FQSs8kZ6zjILQbHDbVoHSL8qN7wVEHkFPfbs2ppWmt6vyYEJwMQDPhtkn4ARv5%2BPbJ0sXgfdRU9wG08SbAgj%2FJSAkUzFtIFTfnO08KFCZT%2BJYw9S8eCV4zWASebiH2utP8Ruzxw5dVYneUUF8%2BVi%2Fcki%2FijCZgKWXl74p6%2Bv%2Bf8EegqmxF9kCCfkuFsQdh3hrSRy0iMWbSur94%2FDLqiR60augNIlT5Fx11e7P%2BQD7Cc5aZdF%2B2wiraBXCkZWqrhqMGjiuV0jNHEQGNhOfkkwsifq866%2F%2BjwBYXWniw08hoKbGoU2NYoMDiZAuvqJ7vwV8MbWVcXnMkW01%2BAy7nH744vbzbavxqgVEFToHkngRE%2FLGLENtnkwjzaTbsp%2ByS3RcyT0izBcfdMLzsK0KwozPxdWFnRggMgFEU%2B2EFK9NeHd4VGWDvVGALVmCjNUl0jJAcjJCX%2BqFNrtuJyz86Tm1yzhrnqda7vVCG26UFVw06WMgDdyzIvs8021NGK5evXbU0t03Lr5lRzeK3D%2BnTWFN3CoSsIh%2BwDjvxuacfBegbNRsFOd76nPQIwT1aH%2BfGA92ZU9WDbdZvqmu5BNtU9GdSaCLVMNHxPNkb3KnaaqPQEtbpQJQZrZyVXWc9pnKi4mmzhvPUcu%2Fv47cfyzI%2BPf%2FMmTsSOptN8WUbXB%2BWar1pbm5VV3VmKBc4ZAinbcKpSxEuV%2FlXTwzKbL%2B3p%2BKEzIafjx94X947kB7cN0ECeMXQtYdfRyEAP%2FTsKmZp7sjF62CXrr5ppTV%2BlIxrQGaKTxQ3OAW8G7Y3MKygdeqZ2QMowmfimqQve8ddVRgYBZniKc9KEqXFCZ5oIOeO%2BDEXzpS5N3cTXwHeykwXHu8F3PHyeRv3OC58mUtxrTZGyyvpTWCjiPsTttGeMHFFCvc6o3dsPxXmjdlcXknVs3e2thV0mrP6aTQGpQpdLvbXg9h86veyvJFTMBJWaqhOKIVT6Cn%2FiMOiEBhpadaOgf4lWYxTskxkFsI9Mx5%2Ba3fK5M9Or5f91%2FEIaeh1x6sUvd%2F%2FLoOir%2FMsI%2B%2BEb)
 
 
### 手順
 README.mdに記載のとおりにアプリケーションを起動し、以下の手順を行うことでlogを扱うことができます。
 
  1. | URL | HTTPメソッド    | API名 |
     | :--- | :---: | ---: |
     | /api/products | POST | 商品登録API |
     | /api/products?title=value	  | GET | 商品複数件取得API |
     | /api/products/{商品ID}  | GET | 商品取得API |
     | /api/products/{商品ID}  | PUT | 商品変更API |
     | /api/products/{商品ID}  | DELETE | 商品削除API |
     | /api/products/{商品ID}/images   | PATCH | 商品画像更新API |
     | /api/products/{商品ID}/images/{商品画像パス}.{拡張子}    | GET | 商品画像削除API |
     
  上記のURLにアクセスすることでログが出力され、tsvファイルに保存します。  
  この時、「2020-05-10.tsv」のようなファイル名で保存されます。
      
  ログが出力する内容
                  
  + 「URL(/api/products/xxx)」
  + 「HTTPメソッド」 
  + 「HTTPステータスコード」
  + 「APIの実行にかかった時間」
  + 「集計日」  
  
  
  2. 1日1回午前1時ごとにTVSファイルの中身がデータベースに保存されます。  
       tsvファイル内のURLがおかしいなどデータに不備が存在しエラーとなった場合には、その行の処理をスキップし、次の行の処理に移動します。
  
   データベースに保存される内容
   + 「API名」
   + 「HTTPメソッド」 
   + 「HTTPステータスコード」
   + 「APIのアクセス回数」
   + 「APIの実行にかかった時間」
   + 「集計日」
      
  3. URL  |  内容
        ---- | ----
         /api-log	  |  APIログ集計検索画面
         /api-log/search	  |  APIログ集計検索実行

   
   上記のURLにアクセスし、開始日と終了日を入力することでデータベースに保存したログを取得し、画面に出力します。
     
     
     
 
 
